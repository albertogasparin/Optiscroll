"function"==typeof window.CustomEvent||function(a){function b(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");return c.initCustomEvent(a,b.bubbles,b.cancelable,b.detail),c}b.prototype=a.Event.prototype,a.CustomEvent=b}(window),function(a,b,c){"use strict";function d(){var a,c,d=b.documentElement,e=0;return a=b.createElement("div"),a.style.cssText="overflow:auto;width:50px;height:50px;position:absolute;left:-100px",c=b.createElement("div"),c.style.cssText="width:100px;height:100px",a.appendChild(c),d.appendChild(a),e=a.offsetWidth-a.clientWidth,d.removeChild(a),e}function e(a){var d=a.charAt(0).toUpperCase()+a.slice(1),e=b.createElement("test"),f=(a+" "+["Webkit","Moz","O","ms"].join(d+" ")+d).split(" ");for(var g in f)if(e.style[f[g]]!==c)return f[g];return!1}function f(a,b,c){var d=a.className.split(/\s+/),e=d.indexOf(b);c?~e||d.push(b):~e&&d.splice(e,1),a.className=d.join(" ")}function g(a,b,d){for(var e in b)!b.hasOwnProperty(e)||a[e]!==c&&d||(a[e]=b[e]);return a}function h(a,b,c){var d,e;if(a.length)for(d=0,e=a.length;e>d;d++)a[d][b].apply(a[d],c);else for(d in a)a[d][b].apply(a[d],c)}var i=function q(a,b){return new q.Instance(a,b||{})},j=i.globalSettings={scrollMinUpdateInterval:25,checkFrequency:1e3,pauseCheck:!1};i.defaults={fixTouchPageBounce:!0,forceScrollbars:!1,scrollStopDelay:300,maxTrackSize:95,minTrackSize:5,draggableTracks:!0,autoUpdate:!0,classPrefix:"optiscroll"},i.Instance=function(a,b){var c=this;c.element=a,c.scrollEl=a.children[0],c.settings=g(g({},i.defaults),b||{}),c.cache={},c.init()},i.Instance.prototype.init=function(){var b=this,c=b.settings;c.autoUpdate&&n.instances.push(b),b.scrollbars={v:new l("v",b),h:new l("h",b)},0===n.nativeScrollbarSize&&"mozRequestAnimationFrame"in a&&(c.forceScrollbars=!1),(n.nativeScrollbarSize||c.forceScrollbars)&&(m.hideNativeScrollbars(b.scrollEl),h(b.scrollbars,"create")),n.isTouch&&c.fixTouchPageBounce&&f(b.element,c.classPrefix+"-nobounce",!0),b.update(),b.bind(),c.autoUpdate&&!n.checkTimer&&m.checkLoop()},i.Instance.prototype.bind=function(){var a=this,b=a.listeners={},c=a.scrollEl;b.scroll=function(b){k.scroll(b,a)},b.overflow=b.underflow=b.overflowchanged=function(){a.update()},n.isTouch&&(b.touchstart=function(b){k.touchstart(b,a)},b.touchend=function(b){k.touchend(b,a)});for(var d in b)c.addEventListener(d,b[d])},i.Instance.prototype.update=function(){var a=this,d=a.cache.clientH,e=a.scrollEl,f=a.cache,g=e.scrollHeight,i=e.clientHeight,j=e.scrollWidth,k=e.clientWidth;if(g!==f.scrollH||i!==f.clientH||j!==f.scrollW||k!==f.clientW){if(0===g&&0===i&&!b.body.contains(a.element))return a.destroy(),!1;f.scrollH=g,f.clientH=i,f.scrollW=j,f.clientW=k,d!==c&&a.fireCustomEvent("sizechange"),h(a.scrollbars,"update")}},i.Instance.prototype.scrollTo=function(a,b,c,d){var e,f,g,h,i=this,j=i.cache;n.pauseCheck=!0,i.update(),e=g=i.scrollEl.scrollLeft,f=h=i.scrollEl.scrollTop,"string"==typeof a?g="left"===a?0:j.scrollW-j.clientW:"number"==typeof a&&(g=a),"string"==typeof b?h="top"===b?0:j.scrollH-j.clientH:"number"==typeof b&&(h=b),i.disableScrollEv=d,i.animateScroll(e,g,f,h,c)},i.Instance.prototype.scrollIntoView=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,o=this,p=o.scrollEl;n.pauseCheck=!0,o.update(),"string"==typeof a&&(a=p.querySelector(a)),a.length&&a.jquery&&(a=a[0]),"number"==typeof c&&(c={top:c,right:c,bottom:c,left:c}),c=c||{},d=a.getBoundingClientRect(),e=p.getBoundingClientRect(),j=l=p.scrollLeft,k=m=p.scrollTop,f=j+d.left-e.left-(c.left||0),g=k+d.top-e.top-(c.top||0),h=j+d.left-e.left+d.width-o.cache.clientW+(c.right||0),i=k+d.top-e.top+d.height-o.cache.clientH+(c.bottom||0),(j>f||h>j)&&(l=j>f?f:h),(k>g||i>k)&&(m=k>g?g:i),o.animateScroll(j,l,k,m,b)},i.Instance.prototype.animateScroll=function(a,b,c,d,e){var f=this,g=f.scrollEl,h=o();if(b!==a||d!==c){if(0===e)return g.scrollLeft=b,g.scrollTop=d,void p(function(){f.disableScrollEv=!1});"number"!=typeof e&&(e=15*Math.pow(Math.max(Math.abs(b-a),Math.abs(d-c)),.62));var i=function(){var j=Math.min(1,(o()-h)/e),k=m.easingFunction(j);d!==c&&(g.scrollTop=k*(d-c)+c),b!==a&&(g.scrollLeft=k*(b-a)+a),1>j?p(i):f.disableScrollEv=!1};p(i)}},i.Instance.prototype.destroy=function(){var a=this,b=a.scrollEl,c=a.listeners,d=n.instances.indexOf(a);for(var e in c)b.removeEventListener(e,c[e]);h(a.scrollbars,"remove"),b.removeAttribute("style"),b.removeAttribute("data-scroll"),f(a.element,a.settings.classPrefix+"-nobounce",!1),d>-1&&p(function(){n.instances.splice(d,1)})},i.Instance.prototype.fireCustomEvent=function(a){var b=m.exposedData(this.cache),c=new CustomEvent(a,{detail:b});this.element.dispatchEvent(c)};var k={scrollTimer:null,stopTimer:null,scroll:function(a,b){var c=b.cache,d=o();b.disableScrollEv||(n.pauseCheck||b.fireCustomEvent("scrollstart"),n.pauseCheck=!0,(!c.now||d>c.now+j.scrollMinUpdateInterval)&&(c.now=d,clearTimeout(c.timerScroll),c.timerScroll=setTimeout(function(){h(b.scrollbars,"update")},j.scrollMinUpdateInterval),clearTimeout(c.timerStop),c.timerStop=setTimeout(function(){k.scrollStop(b)},b.settings.scrollStopDelay)))},touchstart:function(a,b){n.pauseCheck=!1,b.settings.fixTouchPageBounce&&h(b.scrollbars,"update",[!0])},touchend:function(a,b){clearTimeout(b.cache.timerStop)},scrollStop:function(a){a.fireCustomEvent("scrollstop"),n.pauseCheck=!1}},l=function(a,c){var d="v"===a,e=c.element,h=c.scrollEl,i=c.settings,j=c.cache,k=j[a]={},l=d?"H":"W",m="client"+l,o="scroll"+l,p=d?"scrollTop":"scrollLeft",q=d?["top","bottom"]:["left","right"],r="height 0.2s ease 0s, width 0.2s ease 0s, opacity 0.2s ease 0s",s=!1,t=null,u=null,v=null,w=!1;return{toggle:function(b){s=b,u&&(f(e,a+"track-on",s),s&&(u.style[n.cssTransition]=r)),k.enabled=s},create:function(){t=b.createElement("div"),u=b.createElement("b"),t.className=i.classPrefix+"-"+a,u.className=i.classPrefix+"-"+a+"track",t.appendChild(u),e.appendChild(t),i.draggableTracks&&this.bind()},update:function(a){var b,c,e,f=this,l=i.minTrackSize||0,q=i.maxTrackSize||100;b=this.calc(h[p],j[m],j[o],l,q),c=1/b.size*b.position*100,e=Math.abs(b.position-k.position||0)*j[m],1===b.size&&s&&f.toggle(!1),b.size<1&&!s&&f.toggle(!0),u&&s&&(k.size!==b.size&&(u.style[d?"height":"width"]=100*b.size+"%"),e&&(f.animateTrack(n.isTouch&&e>20),u.style[n.cssTransform]="translate("+(d?"0%,"+c+"%":c+"%,0%")+")")),k=g(k,b),f.checkEdges(a)},animateTrack:function(a){(a||w)&&(u.style[n.cssTransition]=r+(a?", "+n.cssTransformDashed+" 0.2s linear 0s":"")),w=a},bind:function(){var a="addEventListener",b=function(a){var b=a.touches?a.touches[0]:a;v={x:b.pageX,y:b.pageY,scroll:h[p]}},c=function(a){var b,c,e=a.touches?a.touches[0]:a;v&&(a.preventDefault(),b=d?e.pageY-v.y:e.pageX-v.x,c=b/j[m],h[p]=v.scroll+c*j[o])},e=function(){v=null};u[a]("mousedown",b),u[a]("touchstart",b),t[a]("mousemove",c),t[a]("touchmove",c),t[a]("mouseup",e),t[a]("touchend",e)},calc:function(a,b,c,d,e){var f,g,h,i=d/100,j=e/100;return f=b/c,1===f||0===c?{position:0,size:1,percent:0}:(g=a/c,h=100*a/(c-b),f>j&&(g+=(f-j)*(h/100),f=j),i>f&&(g+=(f-i)*(h/100),f=i),0>h&&(g=0),h>100&&(g=1-f),{position:g,size:f,percent:h})},checkEdges:function(a){var b,e=k.percent;s&&(k.was===e||e%100!==0||a||(c.fireCustomEvent("scrollreachedge"),c.fireCustomEvent("scrollreach"+q[e/100])),e%100===0&&a&&i.fixTouchPageBounce&&(b=e?k.position*j[o]-1:1,c.scrollTo(d?!1:b,d?b:!1,0,!0)),k.was=e)},remove:function(){this.toggle(!1),t&&t.parentNode&&t.parentNode.removeChild(t)}}},m={hideNativeScrollbars:function(a){if(0===n.nativeScrollbarSize){var b=o();a.setAttribute("data-scroll",b),a.style.display="none",n.isTouch?m.addCssRule('[data-scroll="'+b+'"]::-webkit-scrollbar',"display: none;"):m.addCssRule('[data-scroll="'+b+'"]::-webkit-scrollbar',"width: 0; height: 0;"),p(function(){a.style.display="block"})}else a.style.overflow="scroll",a.style.right=-n.nativeScrollbarSize+"px",a.style.bottom=-n.nativeScrollbarSize+"px"},exposedData:function(a){var b=a.scrollH,c=a.scrollW;return{scrollbarV:g({},a.v),scrollbarH:g({},a.h),scrollTop:a.v.position*b,scrollLeft:a.h.position*c,scrollBottom:(1-a.v.position-a.v.size)*b,scrollRight:(1-a.h.position-a.h.size)*c,scrollWidth:c,scrollHeight:b,clientWidth:a.clientW,clientHeight:a.clientH}},addCssRule:function(a,c){var d=b.getElementById("scroll-sheet");d||(d=b.createElement("style"),d.id="scroll-sheet",b.head.appendChild(d)),d.innerHTML+=a+"{"+c+"} "},checkLoop:function(){return n.instances.length?(n.pauseCheck||h(n.instances,"update"),void(j.checkFrequency&&(n.checkTimer=setTimeout(function(){m.checkLoop()},j.checkFrequency)))):void(n.checkTimer=null)},easingFunction:function(a){return--a*a*a+1}},n=i.G={isTouch:"ontouchstart"in a,cssTransition:e("transition"),cssTransform:e("transform"),nativeScrollbarSize:d(),instances:[],checkTimer:null,pauseCheck:!1};n.cssTransformDashed="transform"===n.cssTransform?n.cssTransform:"-"+n.cssTransform.replace("T","-t").toLowerCase();var o=Date.now||function(){return(new Date).getTime()},p=function(){return a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.msRequestAnimationFrame||function(b){a.setTimeout(b,1e3/60)}}();"function"==typeof define&&define.amd&&define(function(){return i}),"undefined"!=typeof module&&module.exports&&(module.exports=i),a.OptiScroll=i}(window,document);