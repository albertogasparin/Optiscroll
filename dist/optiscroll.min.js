!function(a,b,c){"use strict";function d(){var a,c,d=b.documentElement,e=0;return a=b.createElement("div"),a.style.cssText="overflow:auto;width:50px;height:50px;position:absolute;left:-100px",c=b.createElement("div"),c.style.cssText="width:100px;height:100px",a.appendChild(c),d.appendChild(a),e=a.offsetWidth-a.clientWidth,d.removeChild(a),e}function e(a){var d=a.charAt(0).toUpperCase()+a.slice(1),e=b.createElement("test"),f=(a+" "+["Webkit","Moz","O","ms"].join(d+" ")+d).split(" ");for(var g in f)if(e.style[f[g]]!==c)return f[g];return!1}function f(a,b,d){for(var e in b)!b.hasOwnProperty(e)||a[e]!==c&&d||(a[e]=b[e]);return a}function g(a,b,c){var d,e;if(a.length)for(d=0,e=a.length;e>d;d++)a[d][b].apply(a[d],c);else for(d in a)a[d][b].apply(a[d],c)}{var h=function p(a,b){return new p.Instance(a,b||{})},i=h.globalSettings={scrollMinUpdateInterval:1e3/60,checkFrequency:1e3,pauseCheck:!1};h.defaults={fixTouchPageBounce:!0,forcedScrollbars:!1,scrollStopDelay:300,maxTrackSize:95,minTrackSize:5,draggableTracks:!0,autoUpdate:!0,classPrefix:"optiscroll"}}h.Instance=function(a,b){var c=this;c.element=a,c.scrollEl=a.children[0],c.settings=f(f({},h.defaults),b||{}),c.cache={},c.init()},h.Instance.prototype.init=function(){var a=this,b=m.nativeScrollbarSize||a.settings.forcedScrollbars;a.settings.autoUpdate&&m.instances.push(a),a.scrollbars={v:new k("v",a),h:new k("h",a)},b&&(l.hideNativeScrollbars(a.scrollEl),g(a.scrollbars,"create")),m.isTouch&&a.settings.fixTouchPageBounce&&a.element.classList.add(a.settings.classPrefix+"-touchfix"),a.update(),a.bindEvents(),m.checkTimer||l.checkLoop()},h.Instance.prototype.bindEvents=function(){var a=this,b=a.listeners={},c=a.scrollEl;b.scroll=function(b){j.scroll.call(a,b)},b.overflow=b.underflow=b.overflowchanged=function(){a.update()},m.isTouch&&(b.touchstart=function(b){j.touchstart.call(a,b)},b.touchend=function(b){j.touchend.call(a,b)});for(ev in b)c.addEventListener(ev,b[ev])},h.Instance.prototype.update=function(){var a=this,b=a.cache.clientH,d=a.scrollEl,e=a.cache,f=d.scrollHeight,g=d.clientHeight,h=d.scrollWidth,i=d.clientWidth;if(f!==e.scrollH||g!==e.clientH||h!==e.scrollW||i!==e.clientW){if(0===f&&0===g&&null===a.element.parentNode)return a.destroy(),!1;e.scrollH=f,e.clientH=g,e.scrollW=h,e.clientW=i,b!==c&&a.fireCustomEvent("sizechange"),j.scrollStop.call(a)}},h.Instance.prototype.scrollTo=function(a,b,c,d){var e,f,g,h,i=this,j=i.cache;m.pauseCheck=!0,i.update(),e=g=i.scrollEl.scrollLeft,f=h=i.scrollEl.scrollTop,"string"==typeof a?g="left"===a?0:j.scrollW-j.clientW:"number"==typeof a&&(g=a),"string"==typeof b?h="top"===b?0:j.scrollH-j.clientH:"number"==typeof b&&(h=b),i.disableScrollEv=d,i.animateScroll(e,g,f,h,c)},h.Instance.prototype.scrollIntoView=function(a,b,c){var d,e,f,g,h,i,j,k,l,n,o=this,p=o.scrollEl;m.pauseCheck=!0,o.update(),"string"==typeof a&&(a=p.querySelector(a)),a.length&&a.jquery&&(a=a[0]),"number"==typeof c&&(c={top:c,right:c,bottom:c,left:c}),c=c||{},d=a.getBoundingClientRect(),e=p.getBoundingClientRect(),j=l=p.scrollLeft,k=n=p.scrollTop,f=j+d.left-e.left-(c.left||0),g=k+d.top-e.top-(c.top||0),h=j+d.left-e.left+d.width-e.width+(c.right||0),i=k+d.top-e.top+d.height-e.height+(c.bottom||0),(j>f||h>j)&&(l=j>f?f:h),(k>g||i>k)&&(n=k>g?g:i),o.animateScroll(j,l,k,n,b)},h.Instance.prototype.animateScroll=function(a,b,c,d,e){var f=this,g=f.scrollEl,h=n();if(b!==a||d!==c){if(0===e)return g.scrollLeft=b,g.scrollTop=d,void o(function(){f.disableScrollEv=!1});"number"!=typeof e&&(e=15*Math.pow(Math.max(Math.abs(b-a),Math.abs(d-c)),.62));var i=function(){var j=Math.min(1,(n()-h)/e),k=easingFunction(j);d!==c&&(g.scrollTop=k*(d-c)+c),b!==a&&(g.scrollLeft=k*(b-a)+a),1>j?o(i):f.disableScrollEv=!1};o(i)}},h.Instance.prototype.destroy=function(){var a,b=this,c=b.scrollEl,d=b.listeners,e=m.instances.indexOf(b);e>-1&&m.instances.splice(e,1);for(a in d)c.removeEventListener(a,d[a]);g(b.scrollbars,"remove"),c.removeAttribute("style")},h.Instance.prototype.fireCustomEvent=function(a){var b=l.exposedData(this.cache),c=new CustomEvent(a,{detail:b});this.element.dispatchEvent(c)};var j=h.Events={};j.scroll=function(){var a=this,b=a.cache,c=n();a.disableScrollEv||(m.pauseCheck||a.fireCustomEvent("scrollstart"),m.pauseCheck=!0,c-(b.now||0)>=i.scrollMinUpdateInterval&&(g(a.scrollbars,"update"),b.now=c,clearTimeout(a.sTimer),a.sTimer=setTimeout(function(){j.scrollStop.call(a)},a.settings.scrollStopDelay)))},j.touchstart=function(){var a=this;m.pauseCheck=!1,a.settings.fixTouchPageBounce&&g(a.scrollbars,"update",[!0]),a.cache.now=n()},j.touchend=function(){clearTimeout(this.sTimer)},j.scrollStop=function(){var a=this;g(a.scrollbars,"update"),a.fireCustomEvent("scrollstop"),m.pauseCheck=!1};var k=function(a,c){var d="v"===a,e=c.element,g=c.scrollEl,h=c.settings,i=c.cache,j=i[a]={},k=d?"H":"W",l="client"+k,n="scroll"+k,o=d?"scrollTop":"scrollLeft",p=d?["top","bottom"]:["left","right"],q="height 0.2s ease 0s, width 0.2s ease 0s, opacity 0.2s ease 0s",r=!1,s=null,t=null,u=null,v=!1;return{toggle:function(b){r=b,t&&(e.classList[r?"add":"remove"](a+"track-on"),r&&(t.style[m.cssTransition]=q))},create:function(){s=b.createElement("div"),t=b.createElement("b"),s.className=h.classPrefix+"-"+a,t.className=h.classPrefix+"-"+a+"track",s.appendChild(t),e.appendChild(s),h.draggableTracks&&this.bind()},update:function(a){var b,c,e,k=this,q=h.minTrackSize||0,s=h.maxTrackSize||100;b=this.calc(g[o],i[l],i[n],q,s),c=1/b.size*b.position*100,e=Math.abs(b.position-j.position)*i[l],1===b.size&&r&&k.toggle(!1),b.size<1&&!r&&k.toggle(!0),t&&r&&(j.size!==b.size&&(t.style[d?"height":"width"]=100*b.size+"%"),k.animateTrack(m.isTouch&&e>20),m.cssTransform?t.style[m.cssTransform]="translate("+(d?"0,"+c+"%":c+"%,0")+")":t.style[p[0]]=100*b.position+"%"),j=f(j,b),k.checkEdges(a)},animateTrack:function(a){(a||v)&&(t.style[m.cssTransition]=q+(a?", "+m.cssTransformDashed+" 0.2s linear 0s":"")),v=a},bind:function(){var a="addEventListener",b=function(a){var b=a.touches?a.touches[0]:a;u={x:b.pageX,y:b.pageY,scroll:g[o]}},c=function(a){var b,c,e=a.touches?a.touches[0]:a;u&&(a.preventDefault(),b=d?e.pageY-u.y:e.pageX-u.x,c=b/i[l],g[o]=u.scroll+c*i[n])},e=function(){u=null};t[a]("mousedown",b),t[a]("touchstart",b),s[a]("mousemove",c),s[a]("touchmove",c),s[a]("mouseup",e),s[a]("touchend",e)},calc:function(a,b,c,d,e){var f,g,h,i=d/100,j=e/100;return f=b/c,1===f||0===c?{position:0,size:1,percent:0}:(g=a/c,h=100*a/(c-b),f>j&&(g+=(f-j)*(h/100),f=j),i>f&&(g+=(f-i)*(h/100),f=i),0>h&&(g=0),h>100&&(g=1-f),{position:g,size:f,percent:h})},checkEdges:function(a){var b,e=j.percent;r&&(j.was===e||e%100!==0||a||(c.fireCustomEvent("scrollreachedge"),c.fireCustomEvent("scrollreach"+p[e/100])),e%100===0&&a&&h.fixTouchPageBounce&&(b=e?j.position*i[n]-1:1,c.scrollTo(d?!1:b,d?b:!1,0,!0)),j.was=e)},remove:function(){s&&(this.toggle(!1),e.removeChild(s))}}},l=h.Utils={};l.hideNativeScrollbars=function(a){if(0===m.nativeScrollbarSize){var b=n();a.setAttribute("data-scroll",b),m.isTouch?(a.style.display="none",l.addCssRule('[data-scroll="'+b+'"]::-webkit-scrollbar',"display: none;"),o(function(){a.style.display="block"})):l.addCssRule('[data-scroll="'+b+'"]::-webkit-scrollbar',"width: 0; height: 0;")}else a.style.overflow="scroll",a.style.right=-m.nativeScrollbarSize+"px",a.style.bottom=-m.nativeScrollbarSize+"px"},l.exposedData=function(a){var b=a.scrollH,c=a.scrollW;return{scrollbarV:f({},a.v),scrollbarH:f({},a.h),scrollTop:a.v.position*b,scrollLeft:a.h.position*c,scrollBottom:(1-a.v.position)*b,scrollRight:(1-a.h.position)*c,scrollWidth:c,scrollHeight:b,clientWidth:a.clientW,clientHeight:a.clientH}},l.addCssRule=function(a,c){var d=b.getElementById("scroll-sheet");d||(d=b.createElement("style"),d.appendChild(b.createTextNode("")),d.id="scroll-sheet",b.head.appendChild(d)),d.sheet.insertRule?d.sheet.insertRule(a+"{"+c+"}",0):d.sheet.addRule(a,c)},l.checkLoop=function(){return m.instances.length?(m.pauseCheck||g(m.instances,"update"),void(i.checkFrequency&&(m.checkTimer=setTimeout(function(){l.checkLoop()},i.checkFrequency)))):void(m.checkTimer=null)},l.easingFunction=function(a){return--a*a*a+1};var m={isTouch:"ontouchstart"in a,cssTransition:e("transition"),cssTransform:e("transform"),nativeScrollbarSize:d(),instances:[],checkTimer:null,pauseCheck:!1};m.cssTransformDashed="transform"==m.cssTransform?m.cssTransform:"-"+m.cssTransform.replace("T","-t").toLowerCase();var n=Date.now||function(){return(new Date).getTime()},o=function(){return a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.msRequestAnimationFrame||function(b){a.setTimeout(b,1e3/60)}}();"classList"in b.documentElement||!Object.defineProperty||"undefined"==typeof HTMLElement||Object.defineProperty(HTMLElement.prototype,"classList",{get:function(){function a(a){return function(c){var d=b.className.split(/\s+/),e=d.indexOf(c);a(d,e,c),b.className=d.join(" ")}}var b=this,c={add:a(function(a,b,c){~b||a.push(c)}),remove:a(function(a,b){~b&&a.splice(b,1)})};return c}}),"CustomEvent"in a||function(){function d(a,d){d=d||{bubbles:!1,cancelable:!1,detail:c};var e=b.createEvent("CustomEvent");return e.initCustomEvent(a,d.bubbles,d.cancelable,d.detail),e}d.prototype=a.Event.prototype,a.CustomEvent=d}(),"function"==typeof define&&define.amd&&define(function(){return h}),"undefined"!=typeof module&&module.exports&&(module.exports=h),a.OptiScroll=h}(window,document);