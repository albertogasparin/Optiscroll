/*!
* Optiscroll.js v2.0.0
* https://github.com/wilsonfletcher/Optiscroll/
* by Alberto Gasparin
* 
* @copyright 2016 Wilson Fletcher
* @license Released under MIT LICENSE
*/
!function(a,b,c,d){"use strict";function e(){var a,c,d=b.documentElement,e=0;return a=b.createElement("div"),a.style.cssText="overflow:scroll;width:50px;height:50px;position:absolute;left:-100px",c=b.createElement("div"),c.style.cssText="width:100px;height:100px",a.appendChild(c),d.appendChild(a),e=a.offsetWidth-a.clientWidth,d.removeChild(a),e}function f(a){var c=a.charAt(0).toUpperCase()+a.slice(1),e=b.createElement("test"),f=(a+" "+["Webkit","Moz","O","ms"].join(c+" ")+c).split(" ");for(var g in f)if(e.style[f[g]]!==d)return f[g];return!1}function g(a,b,c){var d=a.className.split(/\s+/),e=d.indexOf(b);c?~e||d.push(b):~e&&d.splice(e,1),a.className=d.join(" ")}function h(a,b,c){for(var e in b)!b.hasOwnProperty(e)||a[e]!==d&&c||(a[e]=b[e]);return a}function i(a,b,c){var d,e;if(a.length)for(d=0,e=a.length;e>d;d++)a[d][b].apply(a[d],c);else for(d in a)a[d][b].apply(a[d],c)}function j(a,b){var c,d;return function(){var e=this,f=Date.now(),g=arguments;c&&c+b>f?(clearTimeout(d),d=setTimeout(function(){c=f,a.apply(e,g)},b)):(c=f,a.apply(e,g))}}"function"==typeof a.CustomEvent||function(a){function c(a,c){c=c||{bubbles:!1,cancelable:!1,detail:d};var e=b.createEvent("CustomEvent");return e.initCustomEvent(a,c.bubbles,c.cancelable,c.detail),e}c.prototype=a.Event.prototype,a.CustomEvent=c}(a),a.requestAnimationFrame||function(a){var b=0;a.requestAnimationFrame=function(a){var d=Date.now(),e=c.max(b+16,d);return setTimeout(function(){a(b=e)},e-d)},a.cancelAnimationFrame=clearTimeout}(a);var k=function q(a,b){return new q.Instance(a,b||{})},l=k.globalSettings={scrollMinUpdateInterval:25,checkFrequency:1e3,pauseCheck:!1};k.defaults={preventParentScroll:!1,forceScrollbars:!1,scrollStopDelay:300,maxTrackSize:95,minTrackSize:5,draggableTracks:!0,autoUpdate:!0,classPrefix:"optiscroll-"},k.Instance=function(a,b){var c=this;c.element=a,c.settings=h(h({},k.defaults),b||{}),c.cache={},c.init()},k.Instance.prototype={init:function(){var a=this,b=a.settings;a.scrollEl=o.createWrapper(a.element,b.classPrefix+"content"),g(a.element,"is-enabled",!0),a.scrollbars={v:n("v",a),h:n("h",a)},(p.nativeScrollbarSize||b.forceScrollbars)&&(o.hideNativeScrollbars(a.scrollEl),i(a.scrollbars,"create")),p.isTouch&&b.preventParentScroll&&g(a.element,b.classPrefix+"prevent",!0),a.update(),a.bind(),b.autoUpdate&&p.instances.push(a),b.autoUpdate&&!p.checkTimer&&o.checkLoop()},bind:function(){var a=this,b=a.listeners={},c=a.scrollEl;b.scroll=j(function(b){m.scroll(b,a)},l.scrollMinUpdateInterval),p.isTouch&&(b.touchstart=function(b){m.touchstart(b,a)},b.touchend=function(b){m.touchend(b,a)}),b.mousewheel=b.wheel=function(b){m.wheel(b,a)};for(var d in b)c.addEventListener(d,b[d])},update:function(){var a=this,c=a.cache.clientH,e=a.scrollEl,f=a.cache,g=e.scrollHeight,h=e.clientHeight,j=e.scrollWidth,k=e.clientWidth;if(g!==f.scrollH||h!==f.clientH||j!==f.scrollW||k!==f.clientW){if(f.scrollH=g,f.clientH=h,f.scrollW=j,f.clientW=k,c!==d){if(0===g&&0===h&&!o.containsNode(b.body,a.element))return a.destroy(),!1;a.fireCustomEvent("sizechange")}i(a.scrollbars,"update")}},scrollTo:function(a,b,c){var d,e,f,g,h=this,i=h.cache;p.pauseCheck=!0,h.update(),d=h.scrollEl.scrollLeft,e=h.scrollEl.scrollTop,f=+a,"left"===a&&(f=0),"right"===a&&(f=i.scrollW-i.clientW),a===!1&&(f=d),g=+b,"top"===b&&(g=0),"bottom"===b&&(g=i.scrollH-i.clientH),b===!1&&(g=e),h.animateScroll(d,f,e,g,+c)},scrollIntoView:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,q=this,r=q.scrollEl;p.pauseCheck=!0,q.update(),"string"==typeof a?a=r.querySelector(a):a.length&&a.jquery&&(a=a[0]),"number"==typeof c&&(c={top:c,right:c,bottom:c,left:c}),c=c||{},d=a.getBoundingClientRect(),e=r.getBoundingClientRect(),l=n=r.scrollLeft,m=o=r.scrollTop,j=l+d.left-e.left,k=m+d.top-e.top,f=j-(c.left||0),g=k-(c.top||0),h=j+d.width-q.cache.clientW+(c.right||0),i=k+d.height-q.cache.clientH+(c.bottom||0),l>f&&(n=f),h>l&&(n=h),m>g&&(o=g),i>m&&(o=i),q.animateScroll(l,n,m,o,+b)},animateScroll:function(b,d,e,f,g){var h=this,i=h.scrollEl,j=Date.now();if(d!==b||f!==e){if(0===g)return i.scrollLeft=d,void(i.scrollTop=f);isNaN(g)&&(g=15*c.pow(c.max(c.abs(d-b),c.abs(f-e)),.54)),function k(){var l=c.min(1,(Date.now()-j)/g),m=o.easingFunction(l);f!==e&&(i.scrollTop=~~(m*(f-e))+e),d!==b&&(i.scrollLeft=~~(m*(d-b))+b),h.scrollAnimation=1>l?a.requestAnimationFrame(k):null}()}},destroy:function(){var b,c=this,d=c.element,e=c.scrollEl,f=c.listeners,h=p.instances.indexOf(c);if(c.scrollEl){for(var j in f)e.removeEventListener(j,f[j]);for(i(c.scrollbars,"remove");b=e.childNodes[0];)d.insertBefore(b,e);d.removeChild(e),c.scrollEl=null,g(d,c.settings.classPrefix+"prevent",!1),g(d,"is-enabled",!1),h>-1&&a.requestAnimationFrame(function(){p.instances.splice(h,1)})}},fireCustomEvent:function(a){var b,c=this,d=c.cache,e=d.scrollH,f=d.scrollW;b={scrollbarV:h({},d.v),scrollbarH:h({},d.h),scrollTop:d.v.position*e,scrollLeft:d.h.position*f,scrollBottom:(1-d.v.position-d.v.size)*e,scrollRight:(1-d.h.position-d.h.size)*f,scrollWidth:f,scrollHeight:e,clientWidth:d.clientW,clientHeight:d.clientH},c.element.dispatchEvent(new CustomEvent(a,{detail:b}))}};var m={scroll:function(a,b){p.pauseCheck||b.fireCustomEvent("scrollstart"),p.pauseCheck=!0,b.scrollbars.v.update(),b.scrollbars.h.update(),b.fireCustomEvent("scroll"),clearTimeout(b.cache.timerStop),b.cache.timerStop=setTimeout(function(){m.scrollStop(b)},b.settings.scrollStopDelay)},touchstart:function(a,b){p.pauseCheck=!1,b.scrollbars.v.update(),b.scrollbars.h.update(),m.wheel(a,b)},touchend:function(a,b){clearTimeout(b.cache.timerStop)},scrollStop:function(a){a.fireCustomEvent("scrollstop"),p.pauseCheck=!1},wheel:function(b,c){var d=c.cache,e=d.v,f=d.h,g=c.settings.preventParentScroll;a.cancelAnimationFrame(c.scrollAnimation),g&&e.enabled&&e.percent%100===0&&(c.scrollEl.scrollTop=e.percent?d.scrollH-d.clientH-1:1),g&&f.enabled&&f.percent%100===0&&(c.scrollEl.scrollLeft=f.percent?d.scrollW-d.clientW-1:1)}},n=function(a,d){var e="v"===a,f=d.element,i=d.scrollEl,j=d.settings,k=d.cache,l=k[a]={},m=e?"H":"W",n="client"+m,o="scroll"+m,q=e?"scrollTop":"scrollLeft",r=e?["top","bottom"]:["left","right"],s=!1,t=null,u=null,v={dragData:null,dragStart:function(a){var b=a.touches?a.touches[0]:a;v.dragData={x:b.pageX,y:b.pageY,scroll:i[q]},v.bind(!0)},dragMove:function(a){var b,c,d=a.touches?a.touches[0]:a;a.preventDefault(),b=e?d.pageY-v.dragData.y:d.pageX-v.dragData.x,c=b/k[n],i[q]=v.dragData.scroll+c*k[o]},dragEnd:function(){v.dragData=null,v.bind(!1)},bind:function(a){var c=(a?"add":"remove")+"EventListener",d=p.isTouch?["touchmove","touchend"]:["mousemove","mouseup"];b[c](d[0],v.dragMove),b[c](d[1],v.dragEnd)}};return{toggle:function(b){s=b,u&&g(f,"has-"+a+"track",s),l.enabled=s},create:function(){var c=p.isTouch?"touchstart":"mousedown";t=b.createElement("div"),u=b.createElement("b"),t.className=j.classPrefix+a,u.className=j.classPrefix+a+"track",t.appendChild(u),f.appendChild(t),j.draggableTracks&&u.addEventListener(c,v.dragStart)},update:function(){var a,b,d,e,f,g=this;(s||k[n]!==k[o])&&(d=this.calc(),a=d.size,b=l.size,e=1/a*d.position*100,f=c.abs(d.position-(l.position||0))*k[n],1===a&&s&&g.toggle(!1),1>a&&!s&&g.toggle(!0),u&&s&&g.style(e,f,a,b),l=h(l,d),s&&g.fireEdgeEv())},style:function(a,b,c,d){c!==d&&(u.style[e?"height":"width"]=100*c+"%"),u.style[p.cssTransform]="translate("+(e?"0%,"+a+"%":a+"%,0%")+")"},calc:function(){var a,b,d=i[q],e=k[n],f=k[o],g=e/f,h=f-e;return g>=1||!f?{position:0,size:1,percent:0}:(b=100*d/h,1>=d&&(b=0),d>=h-1&&(b=100),g=c.max(g,j.minTrackSize/100),g=c.min(g,j.maxTrackSize/100),a=(1-g)*(b/100),{position:a,size:g,percent:b})},fireEdgeEv:function(){var a=l.percent;l.was!==a&&a%100===0&&(d.fireCustomEvent("scrollreachedge"),d.fireCustomEvent("scrollreach"+r[a/100])),l.was=a},remove:function(){this.toggle(!1),t&&(t.parentNode.removeChild(t),t=null)}}},o={hideNativeScrollbars:function(a){var b=p.nativeScrollbarSize,c=a.style;if(0===b){var d=Date.now();a.setAttribute("data-scroll",d),o.addCssRule('[data-scroll="'+d+'"]::-webkit-scrollbar',"display:none;width:0;height:0;")}else c.right=-b+"px",c.bottom=-b+"px"},addCssRule:function(a,c){var d=b.getElementById("scroll-sheet");d||(d=b.createElement("style"),d.id="scroll-sheet",d.appendChild(b.createTextNode("")),b.head.appendChild(d)),d.sheet.insertRule(a+" {"+c+"}",0)},createWrapper:function(a,c){for(var d,e=b.createElement("div");d=a.childNodes[0];)e.appendChild(d);return e.className=c,a.appendChild(e)},containsNode:function(a,b){return a.contains?a!=b&&a.contains(b):!!(16&a.compareDocumentPosition(b))},checkLoop:function(){return p.instances.length?(p.pauseCheck||i(p.instances,"update"),void(l.checkFrequency&&(p.checkTimer=setTimeout(function(){o.checkLoop()},l.checkFrequency)))):void(p.checkTimer=null)},easingFunction:function(a){return--a*a*a+1}},p=k.G={isTouch:"ontouchstart"in a,cssTransition:f("transition"),cssTransform:f("transform")||"",nativeScrollbarSize:e(),instances:[],checkTimer:null,pauseCheck:!1};"function"==typeof define&&define.amd&&define(function(){return k}),"undefined"!=typeof module&&module.exports&&(module.exports=k),a.Optiscroll=k}(window,document,Math);